<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Điều khiển thiết bị</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; line-height: 1.6; }
        h1 { text-align: left; }
        .controls { display: flex; gap: 20px; margin-bottom: 20px; }
        button { font-size: 18px; padding: 10px 20px; cursor: pointer; }
        .status { font-size: 20px; margin: 10px 0; text-align: left; }
        .status span { font-weight: bold; color: blue; }
    </style>
    <script>
        async function toggleDevice(device) {
            const currentState = document.getElementById(device).getAttribute('data-state') === 'on';
            const newState = !currentState;
            const response = await fetch('/control', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ [device]: newState })
            });
            if (!response.ok) {
                alert('Không thể điều khiển thiết bị ' + device);
            } else {
                fetchStatus();
            }
        }

        async function fetchStatus() {
            const response = await fetch('/status');
            const data = await response.json();
            document.getElementById('device1').setAttribute('data-state', data.device1 ? 'on' : 'off');
            document.getElementById('device1').textContent = data.device1 ? 'TẮT THIẾT BỊ 1' : 'BẬT THIẾT BỊ 1';
            document.getElementById('status1').textContent = data.device1 ? 'ON' : 'OFF';
            document.getElementById('device2').setAttribute('data-state', data.device2 ? 'on' : 'off');
            document.getElementById('device2').textContent = data.device2 ? 'TẮT THIẾT BỊ 2' : 'BẬT THIẾT BỊ 2';
            document.getElementById('status2').textContent = data.device2 ? 'ON' : 'OFF';
        }

        window.onload = fetchStatus;
    </script>
</head>
<body>
    <h1>Điều khiển thiết bị</h1>
    <div class="controls">
        <button id="device1" data-state="off" onclick="toggleDevice('device1')">BẬT THIẾT BỊ 1</button>
        <button id="device2" data-state="off" onclick="toggleDevice('device2')">BẬT THIẾT BỊ 2</button>
    </div>
    <div class="status">TRẠNG THÁI THIẾT BỊ 1: <span id="status1" data-state="off">OFF</span></div>
    <div class="status">TRẠNG THÁI THIẾT BỊ 2: <span id="status2" data-state="off">OFF</span></div>
</body>
</html>